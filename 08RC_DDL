/*=================================================================================================
-- 若欄位名稱含關鍵字(ACCOUNT,ACCT,NAME,CUST,MAIL,TEL,BIRTH,PHONE,PASS,SEX,ADD,ADDR,MARITAL,ID,CARD,NMBR)且個資註記為N，請於中文欄位描述前加(REVIEWED)字眼。
=================================================================================================*/

/*=================================================================================================
-- 新增Table
===================================================================================================*/

--顏正忠 08RC  決策行銷廣告檔--
CREATE TABLE INEBAPMGR.TRM_ACTIVITY (
ALIAS_NAME VARCHAR2(60),
AS_OF_DATE DATE NOT NULL,
CANCEL_CODE CHAR(1),
CHANNEL_ID NUMBER(18,0),
CUSTOMER_ID VARCHAR2(16),
DATE_OF_BIRTH DATE,
ECAMP_ID CHAR(12),
GENDER_CODE CHAR(1),
INEB_LAYOUT VARCHAR2(20),
LEAD_ID CHAR(18) NOT NULL,
STEP_ID CHAR(12),
THIS_STEP_DT DATE NOT NULL,
THIS_STEP_END_DT DATE,
CONSTRAINT PK_TRM_ACTIVITY PRIMARY KEY (AS_OF_DATE,LEAD_ID)
);

CREATE INDEX INEBAPMGR.IDX1_TRM_ACTIVITY on INEBAPMGR.TRM_ACTIVITY (CUSTOMER_ID);

COMMENT ON COLUMN INEBAPMGR.TRM_ACTIVITY.ALIAS_NAME IS '(REVIEWED)暱稱@@N';
COMMENT ON COLUMN INEBAPMGR.TRM_ACTIVITY.AS_OF_DATE IS '資料日期@@N';
COMMENT ON COLUMN INEBAPMGR.TRM_ACTIVITY.CANCEL_CODE IS '是否取消訂閱電子報@@N';
COMMENT ON COLUMN INEBAPMGR.TRM_ACTIVITY.CHANNEL_ID IS '(REVIEWED)通路代碼@@N';
COMMENT ON COLUMN INEBAPMGR.TRM_ACTIVITY.CUSTOMER_ID IS '客戶身分證字號@@Y';
COMMENT ON COLUMN INEBAPMGR.TRM_ACTIVITY.DATE_OF_BIRTH IS '客戶生日@@Y';
COMMENT ON COLUMN INEBAPMGR.TRM_ACTIVITY.ECAMP_ID IS '(REVIEWED)ECAMP_ID@@N';
COMMENT ON COLUMN INEBAPMGR.TRM_ACTIVITY.GENDER_CODE IS '客戶性別@@Y';
COMMENT ON COLUMN INEBAPMGR.TRM_ACTIVITY.INEB_LAYOUT IS '活動網頁樣版代碼@@N';
COMMENT ON COLUMN INEBAPMGR.TRM_ACTIVITY.LEAD_ID IS '(REVIEWED)行銷客戶名單代碼(流水號)@@N';
COMMENT ON COLUMN INEBAPMGR.TRM_ACTIVITY.STEP_ID IS '(REVIEWED)溝通步驟代號@@N';
COMMENT ON COLUMN INEBAPMGR.TRM_ACTIVITY.THIS_STEP_DT IS '活動開始日期@@N';
COMMENT ON COLUMN INEBAPMGR.TRM_ACTIVITY.THIS_STEP_END_DT IS '活動結束日期@@N';

grant select,insert,update,delete on INEBAPMGR.TRM_ACTIVITY to EBMWMOD_AP_ROLE;
grant select on INEBAPMGR.TRM_ACTIVITY to EBMWQRY_AP_ROLE;
create synonym EBMWUSR01.TRM_ACTIVITY for INEBAPMGR.TRM_ACTIVITY;
create synonym EBMWUSR02.TRM_ACTIVITY for INEBAPMGR.TRM_ACTIVITY;
create synonym EBMWUSR03.TRM_ACTIVITY for INEBAPMGR.TRM_ACTIVITY;


--黃嘉駿 8RC iMessage ABC GW綁定檔
CREATE TABLE INEBAPMGR.ABC_USER_PROFILE
(
OPAQUE_ID VARCHAR2(170) NOT NULL,
CUST_ID VARCHAR2(11) NOT NULL,
ABC_REGISTERED_DATE DATE,
ABC_LAST_LOGIN_DATE DATE,
BINDING_STATUS VARCHAR2(1) NOT NULL,
CUST_NAME VARCHAR2(42) NOT NULL,
GENDER VARCHAR2(1) NOT NULL,
CONSTRAINT PK_ABC_USER_PROFILE PRIMARY KEY (CUST_ID)
);

CREATE INDEX INEBAPMGR.IDX1_ABC_USER_PROFILE ON INEBAPMGR.ABC_USER_PROFILE (OPAQUE_ID);

COMMENT ON COLUMN INEBAPMGR.ABC_USER_PROFILE.OPAQUE_ID IS '(REVIEWED)Apple Business Chat Gateway ID @@N';
COMMENT ON COLUMN INEBAPMGR.ABC_USER_PROFILE.CUST_ID IS '身分證字號 @@Y';
COMMENT ON COLUMN INEBAPMGR.ABC_USER_PROFILE.ABC_REGISTERED_DATE IS '註冊日期 @@N';
COMMENT ON COLUMN INEBAPMGR.ABC_USER_PROFILE.ABC_LAST_LOGIN_DATE IS '最後登入時間 @@N';
COMMENT ON COLUMN INEBAPMGR.ABC_USER_PROFILE.BINDING_STATUS IS '綁定狀態 (1:綁定,0:未綁定) @@N';
COMMENT ON COLUMN INEBAPMGR.ABC_USER_PROFILE.CUST_NAME IS '姓名 @@Y';
COMMENT ON COLUMN INEBAPMGR.ABC_USER_PROFILE.GENDER IS '性別 @@Y';

GRANT SELECT,INSERT,UPDATE,DELETE on INEBAPMGR.ABC_USER_PROFILE to EBMWMOD_AP_ROLE;
GRANT SELECT on INEBAPMGR.ABC_USER_PROFILE to EBMWQRY_AP_ROLE;
CREATE SYNONYM EBMWUSR01.ABC_USER_PROFILE FOR INEBAPMGR.ABC_USER_PROFILE;
CREATE SYNONYM EBMWUSR02.ABC_USER_PROFILE FOR INEBAPMGR.ABC_USER_PROFILE;
CREATE SYNONYM EBMWUSR03.ABC_USER_PROFILE FOR INEBAPMGR.ABC_USER_PROFILE;



--孫建成 登錄平台揪團功能開發--
CREATE TABLE INEBAPMGR.CAMPAIGN_TEAM_CK
(
CAMPAIGN_CODE VARCHAR2(17) NOT NULL,
TEAM_ID VARCHAR2(10) NOT NULL,
UUID VARCHAR2(128) NOT NULL,
CHECKSUM VARCHAR2(64),
SHORT_URL VARCHAR2(100),
INSERT_DATA_TS TIMESTAMP,
CONSTRAINT PK_CAMPAIGN_TEAM_CK PRIMARY KEY ("CAMPAIGN_CODE", "TEAM_ID")
);

COMMENT ON COLUMN INEBAPMGR.CAMPAIGN_TEAM_CK.CAMPAIGN_CODE IS '(REVIEWED)活動代號@@N';
COMMENT ON COLUMN INEBAPMGR.CAMPAIGN_TEAM_CK.TEAM_ID IS '(REVIEWED)揪團代號@@N';
COMMENT ON COLUMN INEBAPMGR.CAMPAIGN_TEAM_CK.UUID IS '(REVIEWED)隨機UUID供CHECKSUM產生用@@N';
COMMENT ON COLUMN INEBAPMGR.CAMPAIGN_TEAM_CK.CHECKSUM IS '檢核CAMPAIGN_CODE及TEAM_ID之參數值@@N';
COMMENT ON COLUMN INEBAPMGR.CAMPAIGN_TEAM_CK.SHORT_URL IS '短網址@@N'; 
COMMENT ON COLUMN INEBAPMGR.CAMPAIGN_TEAM_CK.INSERT_DATA_TS IS '資料插入時間@@N'; 

grant select,insert,update,delete on INEBAPMGR.CAMPAIGN_TEAM_CK to EBMWMOD_AP_ROLE;
grant select on INEBAPMGR.CAMPAIGN_TEAM_CK to EBMWQRY_AP_ROLE;
create synonym EBMWUSR01.CAMPAIGN_TEAM_CK for INEBAPMGR.CAMPAIGN_TEAM_CK;
create synonym EBMWUSR02.CAMPAIGN_TEAM_CK for INEBAPMGR.CAMPAIGN_TEAM_CK;
create synonym EBMWUSR03.CAMPAIGN_TEAM_CK for INEBAPMGR.CAMPAIGN_TEAM_CK;



--08RC 李宜倢 舊網銀數位開戶資料轉置BRCI
CREATE TABLE INEBAPMGR.DIGITAL_ACCT_TO_BRCI
    (
        ACCOUNT VARCHAR2(16),
        ACCT_TYPE VARCHAR2(6),
        INT_CAT VARCHAR(4),
        ACCOUNT_STATUS VARCHAR2(2),
        DIGITAL_RECOGNITION VARCHAR2(1),
        DIGITAL_TYPE VARCHAR2(1),
        CUST_ID VARCHAR2(11),
        CUST_NAME VARCHAR2(62),
        MOBILE_PHONE VARCHAR2(20),
        ADDRESS VARCHAR2(200),
        ACCT_CREATE_DATE DATE,
        FILE_NAME_STR VARCHAR2(35),
        FILE_NAME_ID1 VARCHAR2(35),
        FILE_NAME_ID2 VARCHAR2(35),
        FILE_NAME_ID3 VARCHAR2(35),
        FILE_NAME_ID4 VARCHAR2(35),
        CREATE_DATE_TIME DATE,
        LAST_MODIFY_DATE_TIME DATE,
        UPLOAD_DEVICE CHAR(1),
        UPLOAD_STATUS CHAR(1),
        STATUS CHAR(1),
        IMAGE_CHK_STATUS CHAR(1),
        CREATOR CHAR(10),
        UPLOAD_OCR_STATUS VARCHAR2(1),
        MGM_ID VARCHAR2(11),
        OPN_ADD_TRN_NUM VARCHAR2(20),
        OPEN_TYPE VARCHAR2(10),
        OPEN_ACCT_TYPE VARCHAR2(10),
        FUN_TYPE VARCHAR2(30),
        USER_NO VARCHAR2(20),
        BILLER_ID VARCHAR2(50),
        ACTIVITY_TYPE VARCHAR2(2),
        ACTIVITY_CODE VARCHAR2(100),
        TRANSPOSE_FLAG VARCHAR2(1),
        TRANSPOSE_STATUS VARCHAR2(1),
        NOT_TRANSPOSE_REASON VARCHAR2(1),
        FAIL_TRANSPOSE_REASON VARCHAR2(1)
    );

CREATE INDEX INEBAPMGR.IDX1_DIGITAL_ACCT_TO_BRCI ON DIGITAL_ACCT_TO_BRCI (CUST_ID,ACCT_CREATE_DATE,FILE_NAME_STR);

COMMENT ON TABLE INEBAPMGR.DIGITAL_ACCT_TO_BRCI IS '數位線上開戶-一次性轉置記錄表';
COMMENT ON COLUMN INEBAPMGR.DIGITAL_ACCT_TO_BRCI.ACCOUNT IS '帳號@@Y';
COMMENT ON COLUMN INEBAPMGR.DIGITAL_ACCT_TO_BRCI.ACCT_TYPE IS '(REVIEWED)產品別@@N';
COMMENT ON COLUMN INEBAPMGR.DIGITAL_ACCT_TO_BRCI.INT_CAT IS '性質別@@N';
COMMENT ON COLUMN INEBAPMGR.DIGITAL_ACCT_TO_BRCI.ACCOUNT_STATUS IS '(REVIEWED)帳戶狀態(0:正常/7:結清/9:凍結)@@N';
COMMENT ON COLUMN INEBAPMGR.DIGITAL_ACCT_TO_BRCI.DIGITAL_RECOGNITION IS '數位辨識(1:未數位辨識/0:已數位辨識/空白或Null:異常資料)@@N';
COMMENT ON COLUMN INEBAPMGR.DIGITAL_ACCT_TO_BRCI.DIGITAL_TYPE IS '數位類型(1:數1/2:數2/3:數3本行卡/F:數3他行帳/空白:已轉一般)@@N';
COMMENT ON COLUMN INEBAPMGR.DIGITAL_ACCT_TO_BRCI.CUST_ID IS '身分證字號@@Y';
COMMENT ON COLUMN INEBAPMGR.DIGITAL_ACCT_TO_BRCI.CUST_NAME IS '用戶姓名@@Y';
COMMENT ON COLUMN INEBAPMGR.DIGITAL_ACCT_TO_BRCI.MOBILE_PHONE IS '手機號碼@@Y';
COMMENT ON COLUMN INEBAPMGR.DIGITAL_ACCT_TO_BRCI.ADDRESS IS '戶籍地址@@Y';
COMMENT ON COLUMN INEBAPMGR.DIGITAL_ACCT_TO_BRCI.ACCT_CREATE_DATE IS '(REVIEWED)開戶成功日@@N';
COMMENT ON COLUMN INEBAPMGR.DIGITAL_ACCT_TO_BRCI.FILE_NAME_STR IS '(REVIEWED)檔案名稱Path@@N';
COMMENT ON COLUMN INEBAPMGR.DIGITAL_ACCT_TO_BRCI.FILE_NAME_ID1 IS '(REVIEWED)檔案名稱@@N';
COMMENT ON COLUMN INEBAPMGR.DIGITAL_ACCT_TO_BRCI.FILE_NAME_ID2 IS '(REVIEWED)檔案名稱@@N';
COMMENT ON COLUMN INEBAPMGR.DIGITAL_ACCT_TO_BRCI.FILE_NAME_ID3 IS '(REVIEWED)檔案名稱@@N';
COMMENT ON COLUMN INEBAPMGR.DIGITAL_ACCT_TO_BRCI.FILE_NAME_ID4 IS '(REVIEWED)檔案名稱@@N';
COMMENT ON COLUMN INEBAPMGR.DIGITAL_ACCT_TO_BRCI.CREATE_DATE_TIME IS '資料建立時間@@N';
COMMENT ON COLUMN INEBAPMGR.DIGITAL_ACCT_TO_BRCI.LAST_MODIFY_DATE_TIME IS '最後異動時間@@N';
COMMENT ON COLUMN INEBAPMGR.DIGITAL_ACCT_TO_BRCI.UPLOAD_DEVICE IS '上傳 device@@N';
COMMENT ON COLUMN INEBAPMGR.DIGITAL_ACCT_TO_BRCI.UPLOAD_STATUS IS '上傳狀態(2：成功/1：非成功(其它狀況))@@N';
COMMENT ON COLUMN INEBAPMGR.DIGITAL_ACCT_TO_BRCI.STATUS IS '開戶狀態(1:開戶成功/2:開戶電文timeout/3:開戶電文失敗/0:其他)@@N';
COMMENT ON COLUMN INEBAPMGR.DIGITAL_ACCT_TO_BRCI.IMAGE_CHK_STATUS IS '影像檔檢查狀態(Y:已確認/N:未確認,影像待補/D:刪除影像/空值或Null:尚未到後台審查)@@N';
COMMENT ON COLUMN INEBAPMGR.DIGITAL_ACCT_TO_BRCI.CREATOR IS '建立者ID@@N';
COMMENT ON COLUMN INEBAPMGR.DIGITAL_ACCT_TO_BRCI.MGM_ID IS '推薦人ID@@Y';
COMMENT ON COLUMN INEBAPMGR.DIGITAL_ACCT_TO_BRCI.OPN_ADD_TRN_NUM IS '(REVIEWED)開戶電文交易序號@@N';
COMMENT ON COLUMN INEBAPMGR.DIGITAL_ACCT_TO_BRCI.OPEN_TYPE IS '開戶類型(1:數一/2:數二/3:數三)@@N';
COMMENT ON COLUMN INEBAPMGR.DIGITAL_ACCT_TO_BRCI.OPEN_ACCT_TYPE IS '(REVIEWED)開戶帳號類型(TW:台幣/FC:外幣)@@N';
COMMENT ON COLUMN INEBAPMGR.DIGITAL_ACCT_TO_BRCI.FUN_TYPE IS '開戶管道@@N';
COMMENT ON COLUMN INEBAPMGR.DIGITAL_ACCT_TO_BRCI.USER_NO IS '電子支付帳號@@Y';
COMMENT ON COLUMN INEBAPMGR.DIGITAL_ACCT_TO_BRCI.BILLER_ID IS '(REVIEWED)業者名稱@@N';
COMMENT ON COLUMN INEBAPMGR.DIGITAL_ACCT_TO_BRCI.ACTIVITY_TYPE IS '推廣業務類別@@N';
COMMENT ON COLUMN INEBAPMGR.DIGITAL_ACCT_TO_BRCI.ACTIVITY_CODE IS '推廣單位代號@@N';
COMMENT ON COLUMN INEBAPMGR.DIGITAL_ACCT_TO_BRCI.TRANSPOSE_FLAG IS '轉置註記 Y:需轉置 N:不需轉置@@N';
COMMENT ON COLUMN INEBAPMGR.DIGITAL_ACCT_TO_BRCI.TRANSPOSE_STATUS IS '轉置狀態 0:未轉置 1:轉置中 2:成功 3:失敗@@N';
COMMENT ON COLUMN INEBAPMGR.DIGITAL_ACCT_TO_BRCI.NOT_TRANSPOSE_REASON IS '不轉置原因 1:該用戶非數位戶 2:無對比相符的資料 3:影像檔狀態為刪除檔案 4:非最新一組開戶資料 5:資料有缺漏(拋送BRCI所需欄位)@@N';     
COMMENT ON COLUMN INEBAPMGR.DIGITAL_ACCT_TO_BRCI.FAIL_TRANSPOSE_REASON IS '失敗原因 1:系統超時 2:發送電文失敗 3:壓縮圖檔失敗 4:上傳圖檔失敗 5:上傳檔名資訊參照檔失敗@@N';

grant select,insert,update,delete on INEBAPMGR.DIGITAL_ACCT_TO_BRCI to EBMWMOD_AP_ROLE;
grant select on INEBAPMGR.DIGITAL_ACCT_TO_BRCI to EBMWQRY_AP_ROLE;

create synonym EBMWUSR01.DIGITAL_ACCT_TO_BRCI for INEBAPMGR.DIGITAL_ACCT_TO_BRCI;
create synonym EBMWUSR02.DIGITAL_ACCT_TO_BRCI for INEBAPMGR.DIGITAL_ACCT_TO_BRCI;
create synonym EBMWUSR03.DIGITAL_ACCT_TO_BRCI for INEBAPMGR.DIGITAL_ACCT_TO_BRCI;


/*=================================================================================================
-- 修改 Table
===================================================================================================*/

--顏正忠 8RC 決策優化機制
-- STG 無此RMS USER, STG不用執行 (BEGEN)-------------
grant select on DW_ETLEBMWTS01MGR.DW_DRV_LOW_POTENTIAL_LEADS to EBMWQRY_AP_ROLE;
grant select on DW_ETLEBMWTS01MGR.DW_DRV_LOW_POTENTIAL_LEADS to EBMWMOD_AP_ROLE;
create synonym EBMWUSR01.DW_DRV_LOW_POTENTIAL_LEADS for DW_ETLEBMWTS01MGR.DW_DRV_LOW_POTENTIAL_LEADS;
create synonym EBMWUSR02.DW_DRV_LOW_POTENTIAL_LEADS for DW_ETLEBMWTS01MGR.DW_DRV_LOW_POTENTIAL_LEADS;
create synonym EBMWUSR03.DW_DRV_LOW_POTENTIAL_LEADS for DW_ETLEBMWTS01MGR.DW_DRV_LOW_POTENTIAL_LEADS;

grant select on ETLINEBTS01.DWCM_C07 to EBMWQRY_AP_ROLE;
grant select on ETLINEBTS01.DWCM_C07 to EBMWMOD_AP_ROLE;
create synonym EBMWUSR01.DWCM_C07 for ETLINEBTS01.DWCM_C07;
create synonym EBMWUSR02.DWCM_C07 for ETLINEBTS01.DWCM_C07;
create synonym EBMWUSR03.DWCM_C07 for ETLINEBTS01.DWCM_C07;
-- STG 無此RMS USER, STG不用執行 (END)------------------


--顏正忠 08RC--
ALTER TABLE INEBAPMGR.USER_PROFILE ADD LOWPOTENTIAL_FLAG CHAR(1);
COMMENT ON COLUMN INEBAPMGR.USER_PROFILE.LOWPOTENTIAL_FLAG IS '低潛力註記@@N';

--08RC 李辰葭 總覽餘額隱藏--
ALTER TABLE INEBAPMGR.USER_PROFILE ADD MASK_CURRENCY CHAR(1) DEFAULT '0' NOT NULL;
COMMENT ON COLUMN INEBAPMGR.USER_PROFILE.MASK_CURRENCY IS '遮蔽金額(0：顯示 1：遮蔽)@@N';

--黃嘉敏 線上數位補件優化 異動註解 增加4:C002此帳號無需補件(集作已人工審核)
COMMENT ON COLUMN INEBAPMGR.DIGITAL_ACCT_PATCH.UPLOAD_STATUS IS '上傳狀態 0:上傳中 1:上傳完成 2:拋送系統中 3:拋送系統完成 4:C002此帳號無需補件(集作已人工審核) @@N';
